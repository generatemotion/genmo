(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{365:function(t,a,e){"use strict";e.r(a);var s=e(14),v=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"tvm安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tvm安装"}},[t._v("#")]),t._v(" TVM安装")]),t._v(" "),a("p",[t._v("本节主要针对在windows下编译安装到conda环境。\n一般有如下几个步骤：")]),t._v(" "),a("ul",[a("li",[t._v("安装conda")]),t._v(" "),a("li",[t._v("安装llvm")]),t._v(" "),a("li",[t._v("tvm源码下载与编译")]),t._v(" "),a("li",[t._v("tvmc测试")])]),t._v(" "),a("h2",{attrs:{id:"安装conda"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装conda"}},[t._v("#")]),t._v(" 安装conda")]),t._v(" "),a("p",[t._v("进入Anaconda官网https://www.anaconda.com/products/distribution，下载Windows版本，下载完成后运行.exe。\n假设安装的目录为d:/anaconda")]),t._v(" "),a("h2",{attrs:{id:"安装llvm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装llvm"}},[t._v("#")]),t._v(" 安装llvm")]),t._v(" "),a("p",[t._v("进入https://winlibs.com/找到包含LLVM的包：\n请选择win64版本，考虑到tvm要求版本至少大于11，请注意选择合适的版本。\n假设安装后的目录为d:/llvm,并把此目录添加到环境变量Path中。")]),t._v(" "),a("h2",{attrs:{id:"安装visual-studio-2019"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装visual-studio-2019"}},[t._v("#")]),t._v(" 安装Visual Studio 2019")]),t._v(" "),a("p",[t._v("从微软网站上下载该版本，进行安装即可")]),t._v(" "),a("h2",{attrs:{id:"获取tvm源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取tvm源码"}},[t._v("#")]),t._v(" 获取TVM源码")]),t._v(" "),a("p",[t._v("从github上获取最新版的TVM克隆到本地文件夹tvm中，记住务必要克隆而非直接下载ZIP解压否则后面编译会报错：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("git clone --recursive http://github.com/apache/tvm tvm\n")])])]),a("p",[t._v("新建一个build文件夹，从文件夹cmake中复制一份config.cmake拷贝到build文件夹中：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd tvm\nmkdir build\n")])])]),a("p",[t._v("将cmake目录下的config.cmake拷贝到build下")]),t._v(" "),a("h2",{attrs:{id:"构建虚拟环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建虚拟环境"}},[t._v("#")]),t._v(" 构建虚拟环境")]),t._v(" "),a("p",[t._v("在Anaconda终端中切换到tvm的文件夹目录下，注意：如果你将Anaconda放在了非系统盘，那么你需要使用管理员身份进入终端。")]),t._v(" "),a("p",[t._v("使用如下命令构建并进入tvm-build的虚拟环境：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# Create a conda environment with the dependencies specified by the yaml\nconda env create --file conda/build-environment.yaml\n# Activate the created environment\nconda activate tvm-build\n")])])]),a("p",[t._v("这个过程会比较长，大概10分钟左右。")]),t._v(" "),a("h2",{attrs:{id:"tvm编译-生成dll库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tvm编译-生成dll库"}},[t._v("#")]),t._v(" tvm编译，生成dll库")]),t._v(" "),a("p",[t._v("首先打开build目录下的config.cmake文件，确保set(USE_LLVM ON)\n安装如下的命令进行编译")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd build\ncmake -A x64 -Thost=x64 ..\n\ncd ..\ncmake --build build --config Release -- /m\n")])])]),a("p",[t._v("这个步骤大概需要半小时左右，如果没有报错，则表示编译成功。在Release目录下会生成几个dll文件")]),t._v(" "),a("ul",[a("li",[t._v("tvm.dll")]),t._v(" "),a("li",[t._v("tvm.exp")]),t._v(" "),a("li",[t._v("tvm.lib")]),t._v(" "),a("li",[t._v("tvm_runtime.dll")]),t._v(" "),a("li",[t._v("tvm_runtime.exp")]),t._v(" "),a("li",[t._v("tvm_runtime.lib")])]),t._v(" "),a("h2",{attrs:{id:"python依赖库的安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python依赖库的安装"}},[t._v("#")]),t._v(" python依赖库的安装")]),t._v(" "),a("p",[t._v("使用如下命令直接安装即可：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(" pip3 install typing_extensions numpy decorator attrs\n pip3 install tornado psutil xgboost cloudpickle\n pip3 install ml_dtypes\n")])])]),a("h2",{attrs:{id:"将tvm安装到python环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将tvm安装到python环境"}},[t._v("#")]),t._v(" 将TVM安装到python环境")]),t._v(" "),a("p",[t._v("这一步看其他大佬的博客都是直接配置PYTHONPATH环境变量，但实际上我们在Anaconda终端直接运行如下脚本即可完成：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd python\npython setup.py install\n")])])]),a("p",[t._v("运行完毕，可以测试一下是否安装成功：\npython")]),t._v(" "),a("blockquote",[a("blockquote",[a("blockquote",[a("p",[t._v("import tvm\n如果没有报错，则表示安装成功。")])])])]),t._v(" "),a("p",[t._v("还需要测试下tvmc是否可以运行，在dos窗口，运行tvmc --help，如果能够正常运行，则说明tvmc也可以运行。\n一般会有找不到llvm错误，这个是值conda环境中没有configs目录，可以把tvm源码库中configs目录整体拷贝到conda的虚拟环境tvm-build中，具体目录为：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("envs\\tvm-build\\Lib\\site-packages\\tvm-0.17.dev143+gab02979a8-py3.9-win-amd64.egg\\tvm\n")])])])])}),[],!1,null,null,null);a.default=v.exports}}]);